<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DNF Mobile 장비 관리</title>

    <link rel="stylesheet" href="styles/merged.css">
</head>
<body>

<h1>캐릭터 장비 관리</h1>

<div class="toolbar" style="display: flex; align-items: center; gap: 10px; flex-wrap: wrap; padding: 10px 0;">
    <button class="action-btn" style="background: linear-gradient(135deg, #6a5acd, #483d8b);" onclick="exportToJSON()">
        💎 JSON 저장 (백업)
    </button>
    <button onclick="saveJsonWithLocation()" class="char-btn" style="background: #e67e22;">📂 JSON 경로 지정 저장</button>
    <label class="file-label" style="background: #2c3e50; margin: 0; cursor: pointer;">
        📥 JSON 불러오기
        <input type="file" id="jsonFile" accept=".json" onchange="importFromJSON(this)" style="display:none;">
    </label>

    <div style="width: 1px; height: 25px; background: #444; margin: 0 5px;"></div>

    <button id="tab-char" class="modal-btn"
            style="background: #4a33cc; color: #ffffff; border: 1px solid #fff; font-weight: bold;"
            onclick="switchTo('char')">획득 장비 등록
    </button>
    <button id="tab-weapon" class="modal-btn"
            style="background: #2a3158; color: #ffffff; border: 1px solid transparent;" onclick="switchTo('weapon')">무기 등록
    </button>
    <button id="tab-equipment" class="modal-btn"
            style="background: #2a3158; color: #ffffff; border: 1px solid transparent;" onclick="switchTo('equipment')">
        장비 현황
    </button>
    <button id="tab-craft" class="modal-btn"
            style="background: #2a3158; color: #ffffff; border: 1px solid transparent;"
            onclick="switchTo('craft')">
        제작 등록
    </button>
    <button id="tab-detail" class="modal-btn"
            style="background: #2a3158; color: #ffffff; border: 1px solid transparent;"
            onclick="switchTo('detail')">
        캐릭터 관리
    </button>

    <div style="width: 1px; height: 25px; background: #444; margin: 0 5px;"></div>

    <button class="action-btn" onclick="showRecentUpdates()">🌟 최근 업데이트</button>

</div>

<div id="section-equipment-view" style="display:none; padding: 20px;">
    <div class="toolbar"
         style="margin-bottom: 20px; display: flex; flex-direction: column; gap: 10px; align-items: flex-start;">

        <div class="equipment-button-row"
             style="display: flex; flex-direction: row; flex-wrap: nowrap; gap: 8px; overflow-x: auto; width: 100%;">
            <button class="char-btn active" style="white-space: nowrap; min-width: 100px;"
                    onclick="renderEquipmentTab('ALL'); setActiveEquipmentButton(this)">모두
            </button>
            <button class="char-btn" style="white-space: nowrap; min-width: 100px;"
                    onclick="renderEquipmentTab('NORMAL'); setActiveEquipmentButton(this)">일반
            </button>
            <button class="char-btn" style="white-space: nowrap; min-width: 100px;"
                    onclick="renderEquipmentTab('PREFIX'); setActiveEquipmentButton(this)">접두어
            </button>
            <button class="char-btn" style="white-space: nowrap; min-width: 100px;"
                    onclick="renderEquipmentTab('EXCEED'); setActiveEquipmentButton(this)">익시드
            </button>
        </div>

        <div class="equipment-button-row"
             style="display: flex; flex-direction: row; flex-wrap: nowrap; gap: 8px; overflow-x: auto; width: 100%;">
            <button class="char-btn" style="white-space: nowrap; min-width: 100px; border-color: #ffd700;"
                    onclick="renderFullEquipmentTab('NORMAL'); setActiveEquipmentButton(this)">일반장비
            </button>
            <button class="char-btn" style="white-space: nowrap; min-width: 100px; border-color: #ffd700;"
                    onclick="renderFullEquipmentTab('PREFIX'); setActiveEquipmentButton(this)">접두어장비
            </button>
            <button class="char-btn" style="white-space: nowrap; min-width: 100px; border-color: #ffd700;"
                    onclick="renderFullEquipmentTab('EXCEED'); setActiveEquipmentButton(this)">익시드장비
            </button>
        </div>

        <!-- ✅ 세 번째 줄도 equipment-button-row 클래스 추가 -->
        <div class="equipment-button-row"
             style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
            <button class="char-btn" style="white-space: nowrap; min-width: 180px; border-color: #ffd700;"
                    onclick="toggleCharacterEquipmentView(); setActiveEquipmentButton(this)">📋 캐릭터별 장비 보유 현황
            </button>
            <button class="char-btn" style="white-space: nowrap; min-width: 100px; border-color: #ffd700;"
                    onclick="showEquipmentStatistics(); setActiveEquipmentButton(this)">📊 통계
            </button>
            <button class="char-btn" style="white-space: nowrap; min-width: 130px; border-color: #ffd700;"
                    onclick="showWeaponStatistics(); setActiveEquipmentButton(this)">⚔️ 무기 보유 현황
            </button>

            <!-- ✅ 검색 기능 추가 -->
            <div style="display: flex; gap: 5px; align-items: center;">
                <input type="text" id="equipment-search-input" placeholder="세트명 검색 (예: 말괄량이)"
                       style="padding: 8px 12px; border-radius: 6px; border: 1px solid #2a3158; background: #181c33; color: #e6e9ff; width: 200px;">
                <button class="char-btn" style="white-space: nowrap; min-width: 80px; background: #25c2a0;"
                        onclick="searchEquipment(); setActiveEquipmentButton(this)">🔍 검색
                </button>
            </div>
        </div>
    </div>

    <div id="equipment-display-area"
         style="overflow-x: auto; background: #0f1222; padding: 15px; border-radius: 8px; border: 1px solid #2a3158;">
    </div>

    <!-- ✅ 새로 추가: 캐릭터 선택 영역 -->
    <div id="character-selection-area" style="display: none; margin-top: 20px;">
        <h3 style="color: #ffd700;">캐릭터 선택</h3>
        <div id="character-buttons-area" style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px;">
        </div>
    </div>

    <!-- ✅ 새로 추가: 캐릭터 장비 현황 표시 영역 -->
    <div id="character-equipment-detail" style="display: none; margin-top: 20px;">
    </div>
</div>


<div id="updateModal" class="modal-overlay">
    <div class="modal-content" style="width: 1200px; max-width: 90vw; max-height: 85vh; overflow-y: auto;">
        <h3>🌟 최근 장비 업데이트</h3>

        <div id="updateModalContent"></div>

        <div id="updatePagination" class="pagination"></div>

        <div class="modal-options" style="margin-top: 30px;">
            <button class="modal-btn modal-cancel-btn" onclick="closeUpdateModal()">닫기</button>
        </div>
    </div>
</div>


<div id="section-character-view">
    <div style="display:flex; align-items:center; gap:10px; margin-bottom:10px;">
        <h2 style="margin:0;">[캐릭터]</h2>
        <button id="edit-order-btn" class="add-btn" style="background: linear-gradient(135deg, #3399cc, #2a6f9e);"
                onclick="toggleEditMode()">✏️편집</button>
    </div>

    <div id="characterList" class="char-grid"></div>
    <div id="characterDetail" class="detail-container" style="display:none;"></div>

    <div id="setList"></div>
    <div id="panel"></div>
</div>

<div id="section-weapon-view" style="display: none; padding-top: 0;">
    <h2>[무기]</h2>
    <div class="toolbar" id="weaponJobButtons">
        <button class="char-btn" onclick="selectWeaponJob('귀검사')">귀검사</button>
        <button class="char-btn" onclick="selectWeaponJob('격투가')">격투가</button>
        <button class="char-btn" onclick="selectWeaponJob('거너')">거너</button>
        <button class="char-btn" onclick="selectWeaponJob('마법사')">마법사</button>
        <button class="char-btn" onclick="selectWeaponJob('프리스트')">프리스트</button>
        <button class="char-btn" onclick="selectWeaponJob('워리어')">워리어</button>
        <button class="char-btn" onclick="selectWeaponJob('마창사')">마창사</button>
        <button class="char-btn" onclick="selectWeaponJob('도적')">도적</button>
    </div>
    <div id="weaponPanel"></div>
</div>

<div id="section-craft-view" style="display:none; padding:20px;">
    <div style="display:flex; align-items:center; gap:10px;">
        <h2 style="margin:0;">[제작]</h2>

        <button id="craft-lock-btn"
                onclick="setCraftLock(true)"
                class="craft-lock-btn active">
            잠금
        </button>

        <button id="craft-unlock-btn"
                onclick="setCraftLock(false)"
                class="craft-lock-btn">
            해제
        </button>

        <button id="craft-calc-btn"
                onclick="applyCraftModulo()"
                class="craft-lock-btn"
                disabled
                style="background:#25c2a0; border-color:#25c2a0; opacity:0.4; cursor:not-allowed;">
            계산
        </button>

        <button id="craft-undo-btn"
                onclick="undoCraftModulo()"
                class="craft-lock-btn"
                disabled
                style="background:#e74c3c; border-color:#e74c3c; opacity:0.4; cursor:not-allowed;">
            실행 취소
        </button>
    </div>
    <div id="craft-table-area"
         style="overflow-x:auto; background:#0f1222; padding:15px;
                border-radius:8px; border:1px solid #2a3158;">
    </div>
</div>



</div>

<div id="actionModal" class="modal-overlay" style="display:none;">
    <div class="modal-content"></div>
</div>

<div id="confirmModal" class="modal-overlay" style="display:none;">
    <div class="modal-content" style="min-width: 300px; text-align: center;">
        <h3 id="confirmTitle" style="color: #fff; margin-bottom: 15px;"></h3>
        <p id="confirmMessage" style="color: #ccc; margin-bottom: 25px;"></p>

        <div class="modal-options" style="display: flex; gap: 10px; justify-content: center;">
            <button id="confirmYes" class="modal-btn" style="background: #e74c3c; flex: 1; color: #fff;">확인</button>
            <button class="modal-btn" style="background: #444; flex: 1; color: #fff;" onclick="closeConfirmModal()">취소
            </button>
        </div>
    </div>
</div>
<!-- ================================================
     상세 입력 탭 (project1)
================================================ -->
<div id="section-detail-view" style="display: none;">

    <!-- 컨트롤바 -->
    <div class="control-bar">
        <button onclick="addCharacter()" class="add-btn" style="background: linear-gradient(135deg, #25c2a0, #1a8a70);">➕ 캐릭터 추가</button>
        <button onclick="lockAllCharacters()" class="btn-all-lock">전체 잠금</button>
        <button class="btn-mode active" id="btnBasicMode" onclick="switchToBasicMode()">📋 기본</button>
        <button class="btn-mode" id="btnCompareMode" onclick="enterCompareMode()">⚖️ 비교</button>
        <button class="btn-mode" id="btnSearchMode" onclick="enterSearchMode()">🔍 검색</button>
        <button class="btn-mode" id="btnTagFilter" onclick="toggleTagFilterPanel()">🏷️ 태그</button>
        <span id="statusMsg" class="status-msg"></span>
    </div>

    <!-- 비교 모드 UI -->
    <div id="compareCharSelectionContainer">
        <h3 class="modal-title">⚖️ 비교할 캐릭터 선택</h3>
        <p>왼쪽과 오른쪽에서 각각 1명 씩을 선택해주세요.</p>
        <div class="compare-select-container">
            <div class="compare-select-wrapper">
                <label class="compare-select-label">⬅️ 왼쪽 선택</label>
                <select id="compareCharacterSelectLeft" class="compare-select">
                    <option value="">캐릭터 선택...</option>
                </select>
            </div>
            <div class="compare-select-wrapper">
                <label class="compare-select-label">➡️ 오른쪽 선택</label>
                <select id="compareCharacterSelectRight" class="compare-select">
                    <option value="">캐릭터 선택...</option>
                </select>
            </div>
        </div>
    </div>
    <div id="compareContainer">
        <div id="compareContent"></div>
    </div>

    <!-- 검색 모드 UI -->
    <div id="searchContainer" style="display: none;">
        <h3 class="modal-title">🔍 슬롯 검색</h3>
        <div style="margin: 20px 0; text-align: center;">
            <select id="searchSlotSelect" style="
                width: 200px; height: 50px; font-size: 15px; font-weight: bold;
                background: #333333; color: #ffffff; border: 3px solid #ffd700;
                border-radius: 4px; padding: 10px; padding-right: 40px;
                -webkit-appearance: none; -moz-appearance: none; appearance: none;
                background-image: url('data:image/svg+xml;charset=UTF-8,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 24 24%27 fill=%27none%27 stroke=%27%23ffd700%27 stroke-width=%272%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27%3e%3cpolyline points=%276 9 12 15 18 9%27%3e%3c/polyline%3e%3c/svg%3e');
                background-repeat: no-repeat; background-position: right 10px center;
                background-size: 24px; cursor: pointer;">
                <option value="" disabled selected>▼ 슬롯 선택...</option>
            </select>
        </div>
        <div id="searchResultContent" style="margin-top: 20px;"></div>
    </div>

    <!-- 캐릭터 목록 -->
    <div id="characterContainer"></div>

    <!-- 스킬룬 모달 배경 -->
    <div class="modal-overlay" id="modalOverlay" onclick="closeRuneModal()"></div>

    <!-- 스킬룬 모달 -->
    <div id="skillRunemodal">
        <h3 class="modal-title">💎 스킬룬 & 각인 설정</h3>
        <div class="modal-flex-row">
            <select id="m-batch-rune-name" class="bg-row text-white border-gold modal-flex-col"></select>
            <button class="btn-action modal-flex-col-wide" style="background:var(--btn-add);" onclick="setAllRunesBatch()">룬 설정</button>
        </div>
        <div class="modal-flex-row">
            <select id="m-batch-rune-lv" class="bg-row text-white border-gold modal-flex-col"></select>
            <button class="btn-action modal-flex-col-wide" style="background:var(--btn-success);" onclick="setAllRuneLevels()">레벨 설정</button>
        </div>
        <div class="modal-flex-row">
            <select id="m-batch-skill-lv" class="bg-row text-white border-gold modal-flex-col"></select>
            <button class="btn-action modal-flex-col-wide" style="background:var(--btn-lock);" onclick="setAllSkillLevels()">레벨로 설정</button>
        </div>
        <table class="rune-modal-table">
            <thead>
            <tr class="text-gold">
                <th class="col-m-num">번호</th>
                <th style="width:68px;">스킬룬 이름</th>
                <th style="width:48px;">룬 레벨</th>
                <th style="width:50px;">스킬 레벨</th>
            </tr>
            </thead>
            <tbody id="runeModalBody"></tbody>
        </table>
        <div class="gakin-section">
            <div class="gakin-title">각인 설정</div>
            <div class="gakin-container">
                <div class="m-gakin-input-box"><input type="text" id="m-gakin1" placeholder="메인 미표시 (50%)"></div>
                <div class="m-gakin-input-box"><input type="text" id="m-gakin2" placeholder="메인 표시 (50%)"></div>
            </div>
        </div>
        <div class="modal-button-group">
            <button class="btn-action" style="background:var(--btn-success);" onclick="saveRuneData()">저장</button>
            <button class="btn-action" style="background:var(--btn-secondary);" onclick="closeRuneModal()">취소</button>
        </div>
    </div>

    <!-- 히스토리 모달 -->
    <div id="historyModal">
        <h3 class="modal-title">📝 최근 변경 기록 (최근 10개)</h3>
        <div id="historyList"></div>
        <div class="modal-button-group text-center">
            <button class="btn-action" style="background:var(--btn-secondary);" onclick="closeHistoryModal()">닫기</button>
        </div>
    </div>

    <!-- 세트 컨텍스트 메뉴 (공유) -->
    <div id="setContextMenu" style="display:none;"></div>

    <!-- 캐릭터 테이블 템플릿 -->
    <template id="character-info-template">
        <td class="col-char-info bg-section" rowspan="18" style="vertical-align: top;">
            <div class="d-flex flex-column gap-sm" style="padding: var(--spacing-md);">
                <div class="d-flex gap-sm">
                    <select data-key="info_stat_type" class="info-select" onchange="applySealHighlight('{CHAR_ID}'); autoSave();">
                        <option value="">(스탯)</option>
                        <option value="힘">힘</option>
                        <option value="지능">지능</option>
                    </select>
                    <select data-key="info_ele_type" class="info-select" onchange="applySealHighlight('{CHAR_ID}'); autoSave();">
                        <option value=""></option>
                        <option value="화속강">화속강</option>
                        <option value="수속강">수속강</option>
                        <option value="명속강">명속강</option>
                        <option value="암속강">암속강</option>
                    </select>
                </div>
                <div class="divider-gold"></div>
                <input type="text" placeholder="직업" data-key="info_job" oninput="autoSave()">
                <input type="text" placeholder="이름" data-key="info_name" oninput="autoSave()">
                <input type="text" placeholder="항마력" data-key="info_power" oninput="autoSave()">
                <div class="divider-gold"></div>
                <div style="margin-bottom: 8px;">
                    <label class="memo-tag-label" style="display: block; margin-bottom: 4px;">📝 메모</label>
                    <div id="{CHAR_ID}_memo_preview" onclick="openMemoModal('{CHAR_ID}')"
                         style="padding: 8px 10px; background: rgba(255,255,255,0.05); border: 1px solid #444;
                                border-radius: 4px; font-size: 12px; color: #aaa; font-style: italic;
                                min-height: 32px; cursor: pointer; transition: all 0.2s;">(메모 없음)</div>
                    <textarea data-key="info_memo" style="display: none;" oninput="updateMemoPreview('{CHAR_ID}')"></textarea>
                </div>
                <div>
                    <label class="memo-tag-label">🏷️ 태그</label>
                    <div style="display: flex; gap: 5px; margin-bottom: 5px;">
                        <input data-key="info_tag_input" type="text" placeholder="#태그" style="flex: 1; font-size: 13px;"
                               oninput="showTagAutocomplete('{CHAR_ID}', this.value)"
                               onkeydown="handleAutocompleteKeyboard(event, '{CHAR_ID}')"
                               onkeypress="handleTagInput(event, '{CHAR_ID}')">
                        <button class="btn-action" onclick="addTag('{CHAR_ID}')"
                                style="padding: 4px 8px; font-size: 12px; background: var(--btn-success);">+</button>
                    </div>
                    <div id="{CHAR_ID}_tags" class="tag-container"></div>
                </div>
                <div class="divider-gold"></div>
                <button onclick="toggleEdit('{CHAR_ID}', true)" class="btn-char-lock lock-btn">잠금</button>
                <button onclick="toggleEdit('{CHAR_ID}', false)" class="btn-char-unlock unlock-btn">해제</button>
                <div class="divider-gold-lg"></div>
                <div class="d-flex gap-xs" style="margin-bottom: var(--spacing-sm);">
                    <button onclick="moveCharacter('{CHAR_ID}', 'up')" class="btn-action btn-move">▲</button>
                    <button onclick="moveCharacter('{CHAR_ID}', 'down')" class="btn-action btn-move">▼</button>
                </div>
                <button onclick="deleteCharacter('{CHAR_ID}')" class="del-btn">삭제</button>
            </div>
        </td>
    </template>

    <template id="equipment-row-template">
        <tr>
            <td class="col-slot v-border-heavy">{SLOT_NAME}</td>
            <td class="col-rarity">
                <select data-key="{SLOT}_rarity" data-slot="{SLOT}" onchange="updateStyle(this, 'rarity')" class="rare-에픽">
                    <option>에픽</option><option>유니크</option><option>레어</option><option>언커먼</option><option>커먼</option><option>티어</option>
                </select>
            </td>
            <td class="col-exceed">
                <select data-key="{SLOT}_exceed" data-slot="{SLOT}" onchange="updateStyle(this,'exceed')">
                    <option></option><option>이상</option><option>선봉</option><option>의지</option>
                </select>
            </td>
            <td class="col-prefix">
                <select data-key="{SLOT}_prefix" data-slot="{SLOT}" onchange="updateStyle(this,'prefix')">
                    <option></option><option>전격</option><option>허상</option><option>작열</option><option>침식</option>
                    <option>수호</option><option>왜곡</option><option>자상</option><option>맹독</option>
                    <option>보호</option><option>쇄도</option><option>신속</option><option>연격</option>
                </select>
            </td>
            <td><input type="text" data-key="{SLOT}_itemname" class="rare-에픽 itemname-color-sync" oninput="autoSave()"></td>
            <td class="col-val-short"><input type="text" data-key="{SLOT}_reinforce" oninput="autoSave()"></td>
            <td><select data-key="{SLOT}_seal1" data-slot="{SLOT}" onchange="handleSealChange(this)"><option></option></select></td>
            <td class="col-val-short"><input type="text" data-key="{SLOT}_seal1_val" oninput="applySealHighlight('{CHAR_ID}'); autoSave();"></td>
            <td><select data-key="{SLOT}_seal2" data-slot="{SLOT}" onchange="handleSealChange(this)"><option></option></select></td>
            <td class="col-val-short"><input type="text" data-key="{SLOT}_seal2_val" oninput="applySealHighlight('{CHAR_ID}'); autoSave();"></td>
            <td class="col-emblem {EMB_CLASS}"><input type="text" data-key="{SLOT}_emb1" oninput="autoSave()"></td>
            <td class="col-emblem {EMB_CLASS}"><input type="text" data-key="{SLOT}_emb2" oninput="autoSave()"></td>
            <td class="col-enchant"><input type="text" data-key="{SLOT}_enchant" value="{DEFAULT_ENCHANT}" oninput="autoSave()"></td>
            <td class="col-val-short"><input type="text" data-key="{SLOT}_enchant_val" value="{DEFAULT_ENCHANT_VAL}" oninput="autoSave()"></td>
            <td class="v-border-heavy">
                <textarea data-key="{SLOT}_desc" readonly onclick="openDescModal(this)"
                          style="text-align:left; padding-left:6px; cursor:pointer; width:100%; height:var(--height-row);
                                 resize:none; overflow:hidden; box-sizing:border-box; background:var(--input-bg);
                                 border:var(--border-width) var(--border-style) var(--border); font:inherit;
                                 color:var(--color-white); display:block;"></textarea>
            </td>
        </tr>
    </template>

    <template id="skillrune-row-template">
        <tr>
            <td class="col-slot v-border-heavy">스킬룬</td>
            <td colspan="3">
                <button class="btn-action" onclick="openRuneModal('{CHAR_ID}')" style="background:var(--btn-success); padding:var(--padding-sm);">수정</button>
                <button class="btn-action" onclick="resetRuneData('{CHAR_ID}')" style="background:var(--btn-secondary); padding:var(--padding-sm);">초기화</button>
            </td>
            <td colspan="10" id="{CHAR_ID}_runeSummary" class="text-left text-gold font-bold"
                style="padding-left:var(--spacing-xl); font-size:var(--fs-table);">설정된 룬 없음</td>
            <td class="v-border-heavy">
                <textarea data-key="스킬룬_desc" readonly onclick="openDescModal(this)"
                          style="text-align:left; padding-left:6px; cursor:pointer; width:100%; height:var(--height-row);
                                 resize:none; overflow:hidden; box-sizing:border-box; background:var(--input-bg);
                                 border:var(--border-width) var(--border-style) var(--border); font:inherit;
                                 color:var(--color-white); display:block;"></textarea>
            </td>
        </tr>
    </template>

    <template id="creature-row-template">
        <tr>
            <td class="col-slot v-border-heavy">크리쳐</td>
            <td class="col-rarity">
                <select data-key="크리쳐_rarity" onchange="updateStyle(this, 'rarity')" class="rare-에픽">
                    <option>에픽</option><option>유니크</option><option>레어</option><option>언커먼</option><option>커먼</option>
                </select>
            </td>
            <td colspan="2"><input type="text" data-key="크리쳐_name" placeholder="크리쳐 이름" class="rare-에픽" oninput="autoSave()"></td>
            <td colspan="10">
                <div class="artifact-main-wrapper">
                    <div class="art-group">
                        <div class="art-item custom-top-line">
                            <select data-key="크리쳐_art_red_top_rarity" class="art-color-select bg-에픽" onchange="updateStyle(this,'artBg')"><option>에픽</option><option>유니크</option><option>레어</option><option>언커먼</option><option>커먼</option></select>
                            <input type="text" data-key="크리쳐_art_red_top_text" class="art-opt-select bg-에픽" placeholder="내용 입력" oninput="autoSave()">
                        </div>
                        <div class="art-item">
                            <select data-key="크리쳐_art_red_bg_1" class="art-color-select bg-에픽" onchange="updateStyle(this,'artBg')"><option>에픽</option><option>유니크</option><option>레어</option><option>언커먼</option><option>커먼</option></select>
                            <select data-key="크리쳐_art_red_opt_1" class="art-opt-select bg-에픽" onchange="autoSave()"><option value="">옵션 선택</option><option>힘</option><option>지능</option><option>체력</option><option>정신력</option><option>적중</option><option>회피</option></select>
                        </div>
                        <div class="art-item">
                            <select data-key="크리쳐_art_red_bg_2" class="art-color-select bg-에픽" onchange="updateStyle(this,'artBg')"><option>에픽</option><option>유니크</option><option>레어</option><option>언커먼</option><option>커먼</option></select>
                            <select data-key="크리쳐_art_red_opt_2" class="art-opt-select bg-에픽" onchange="autoSave()"><option value="">옵션 선택</option><option>힘</option><option>지능</option><option>체력</option><option>정신력</option><option>적중</option><option>회피</option></select>
                        </div>
                    </div>
                    <div class="art-group">
                        <div class="art-item custom-top-line">
                            <select data-key="크리쳐_art_blue_top_rarity" class="art-color-select bg-에픽" onchange="updateStyle(this,'artBg')"><option>에픽</option><option>유니크</option><option>레어</option><option>언커먼</option><option>커먼</option></select>
                            <input type="text" data-key="크리쳐_art_blue_top_text" class="art-opt-select bg-에픽" placeholder="내용 입력" oninput="autoSave()">
                        </div>
                        <div class="art-item">
                            <select data-key="크리쳐_art_blue_bg_1" class="art-color-select bg-에픽" onchange="updateStyle(this,'artBg')"><option>에픽</option><option>유니크</option><option>레어</option><option>언커먼</option><option>커먼</option></select>
                            <select data-key="크리쳐_art_blue_opt_1" class="art-opt-select bg-에픽" onchange="autoSave()"><option value="">옵션 선택</option><option>HP MAX</option><option>MP MAX</option><option>물리 공격력</option><option>마법 공격력</option><option>물리 방어력</option><option>마법 방어력</option></select>
                        </div>
                        <div class="art-item">
                            <select data-key="크리쳐_art_blue_bg_2" class="art-color-select bg-에픽" onchange="updateStyle(this,'artBg')"><option>에픽</option><option>유니크</option><option>레어</option><option>언커먼</option><option>커먼</option></select>
                            <select data-key="크리쳐_art_blue_opt_2" class="art-opt-select bg-에픽" onchange="autoSave()"><option value="">옵션 선택</option><option>HP MAX</option><option>MP MAX</option><option>물리 공격력</option><option>마법 공격력</option><option>물리 방어력</option><option>마법 방어력</option></select>
                        </div>
                    </div>
                    <div class="art-group">
                        <div class="art-item custom-top-line">
                            <select data-key="크리쳐_art_green_top_rarity" class="art-color-select bg-에픽" onchange="updateStyle(this,'artBg')"><option>에픽</option><option>유니크</option><option>레어</option><option>언커먼</option><option>커먼</option></select>
                            <input type="text" data-key="크리쳐_art_green_top_text" class="art-opt-select bg-에픽" placeholder="내용 입력" oninput="autoSave()">
                        </div>
                        <div class="art-item">
                            <select data-key="크리쳐_art_green_bg_1" class="art-color-select bg-에픽" onchange="updateStyle(this,'artBg')"><option>에픽</option><option>유니크</option><option>레어</option><option>언커먼</option><option>커먼</option></select>
                            <select data-key="크리쳐_art_green_opt_1" class="art-opt-select bg-에픽" onchange="autoSave()"><option value="">옵션 선택</option><option>물리 크리티컬</option><option>마법 크리티컬</option><option>공격속도</option><option>캐스팅속도</option><option>이동속도</option><option>화속강</option><option>수속강</option><option>명속강</option><option>암속강</option><option>모속강</option></select>
                        </div>
                        <div class="art-item">
                            <select data-key="크리쳐_art_green_bg_2" class="art-color-select bg-에픽" onchange="updateStyle(this,'artBg')"><option>에픽</option><option>유니크</option><option>레어</option><option>언커먼</option><option>커먼</option></select>
                            <select data-key="크리쳐_art_green_opt_2" class="art-opt-select bg-에픽" onchange="autoSave()"><option value="">옵션 선택</option><option>물리 크리티컬</option><option>마법 크리티컬</option><option>공격속도</option><option>캐스팅속도</option><option>이동속도</option><option>화속강</option><option>수속강</option><option>명속강</option><option>암속강</option><option>모속강</option></select>
                        </div>
                    </div>
                </div>
            </td>
            <td class="v-border-heavy">
                <textarea data-key="크리쳐_desc" readonly onclick="openDescModal(this)"
                          style="text-align:left; padding-left:6px; cursor:pointer; width:100%; height:var(--height-row);
                                 resize:none; overflow:hidden; box-sizing:border-box; background:var(--input-bg);
                                 border:var(--border-width) var(--border-style) var(--border); font:inherit;
                                 color:var(--color-white); display:block;"></textarea>
            </td>
        </tr>
    </template>

    <template id="title-row-template">
        <tr>
            <td class="col-slot v-border-heavy">칭호</td>
            <td class="col-rarity">
                <select data-key="칭호_rarity" data-slot="칭호" onchange="updateStyle(this,'rarity')" class="rare-에픽">
                    <option>에픽</option><option>유니크</option><option>레어</option><option>언커먼</option><option>커먼</option>
                </select>
            </td>
            <td>-</td><td>-</td>
            <td><input type="text" data-key="칭호_itemname" class="rare-에픽 itemname-color-sync" oninput="autoSave()"></td>
            <td class="col-val-short">-</td><td>-</td><td class="col-val-short">-</td><td>-</td><td class="col-val-short">-</td>
            <td class="col-emblem">
                <select data-key="칭호_emb1" class="emb-bg-gray" onchange="autoSave()">
                    <option></option><option>모속강</option><option>화속강</option><option>수속강</option><option>명속강</option><option>암속강</option><option>힘</option><option>지능</option>
                </select>
            </td>
            <td class="col-emblem emb-bg-gray"><input type="text" data-key="칭호_emb2" oninput="autoSave()"></td>
            <td class="col-enchant"><input type="text" data-key="칭호_enchant" oninput="autoSave()"></td>
            <td class="col-val-short"><input type="text" data-key="칭호_enchant_val" oninput="autoSave()"></td>
            <td rowspan="2" class="v-border-heavy" style="padding:var(--spacing-xs); vertical-align:middle;">
                <textarea data-key="칭호_desc" readonly onclick="openDescModal(this)"
                          style="width:calc(100% - 4px); height:calc(100% - 2px); min-height:var(--height-textarea-min); cursor:pointer;"></textarea>
            </td>
        </tr>
    </template>

    <template id="appearance-title-row-template">
        <tr>
            <td class="col-slot v-border-heavy">외형칭호</td>
            <td class="col-rarity">
                <select tabindex="-1" data-key="외형칭호_rarity" data-slot="외형칭호" onchange="updateStyle(this,'rarity')" class="rare-에픽">
                    <option>에픽</option><option>유니크</option><option>레어</option><option>언커먼</option><option>커먼</option>
                </select>
            </td>
            <td>-</td><td>-</td>
            <td><input tabindex="-1" type="text" data-key="외형칭호_itemname" class="rare-에픽 itemname-color-sync" oninput="autoSave()"></td>
            <td class="col-val-short">-</td><td>-</td><td class="col-val-short">-</td><td>-</td><td class="col-val-short">-</td>
            <td>-</td><td>-</td><td>-</td><td class="col-val-short">-</td>
        </tr>
    </template>

    <template id="simple-row-template">
        <tr>
            <td class="col-slot v-border-heavy">{SLOT_NAME}</td>
            <td class="col-rarity">
                <select tabindex="-1" data-key="{SLOT}_rarity" data-slot="{SLOT}" onchange="updateStyle(this,'rarity')" class="rare-에픽">
                    <option>에픽</option><option>유니크</option><option>레어</option><option>언커먼</option><option>커먼</option>
                </select>
            </td>
            <td>-</td><td>-</td>
            <td><input tabindex="-1" type="text" data-key="{SLOT}_itemname" class="rare-에픽 itemname-color-sync" oninput="autoSave()"></td>
            <td class="col-val-short">-</td><td>-</td><td class="col-val-short">-</td><td>-</td><td class="col-val-short">-</td>
            <td>-</td><td>-</td><td>-</td><td class="col-val-short">-</td>
            <td class="v-border-heavy">
                <textarea data-key="{SLOT}_desc" readonly onclick="openDescModal(this)"
                          style="text-align:left; padding-left:6px; cursor:pointer; width:100%; height:var(--height-row);
                                 resize:none; overflow:hidden; box-sizing:border-box; background:var(--input-bg);
                                 border:var(--border-width) var(--border-style) var(--border); font:inherit;
                                 color:var(--color-white); display:block;"></textarea>
            </td>
        </tr>
    </template>

</div><!-- /section-detail-view -->

<!--gap 값: 화살표 사이 간격-->
<div class="scroll-buttons" style="position: fixed; bottom: 20px; right: 20px; display: flex; flex-direction: column; gap: 5px; z-index: 1000;">
    <button onclick="window.scrollTo({top: 0, behavior: 'smooth'})"
            style="width: 40px; height: 40px; border-radius: 50%; background: #4a33cc; color: white; border: 2px solid #fff; cursor: pointer; font-size: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.3);">
        ▲
    </button>
    <button onclick="window.scrollTo({top: document.body.scrollHeight, behavior: 'smooth'})"
            style="width: 40px; height: 40px; border-radius: 50%; background: #4a33cc; color: white; border: 2px solid #fff; cursor: pointer; font-size: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.3);">
        ▼
    </button>
</div>

<!-- 공유 데이터/상수 -->
<script src="shared/shared_data.js"></script>
<script src="shared/shared_constants.js"></script>
<script src="shared/shared_weapon.js"></script>

<!-- project2 스크립트 -->
<script src="scripts/eq_data.js"></script>
<script src="scripts/eq_core.js"></script>
<script src="scripts/eq_character.js"></script>
<script src="scripts/eq_equipment.js"></script>
<script src="scripts/eq_weapon.js"></script>
<script src="scripts/eq_main.js"></script>

<!-- project1 스크립트 -->
<script src="js/state.js"></script>
<script src="js/utils.js"></script>
<script src="js/storage.js"></script>
<script src="js/ui-core.js"></script>
<script src="js/ui-character.js"></script>
<script src="js/ui-rune.js"></script>
<script src="js/ui-modal.js"></script>
<script src="js/ui-compare.js"></script>
<script src="js/ui-search.js"></script>
<script src="js/ui-templates.js"></script>
<script src="js/ui-memo-tag.js"></script>
<script src="js/ui-tag-filter.js"></script>
<script src="js/main.js"></script>

</body>
</html>