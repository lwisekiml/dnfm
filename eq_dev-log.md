# DNF Mobile 장비 관리 - 개발 로그

---

## 2026-02-22

### 1. 세트 이름 칸 가로 너비 개선 (`equipment.js`)

**변경 전**
- 방어구/악세/특장 모든 표의 세트 이름 열이 전역 `globalSetNameWidth` 값으로 통일 적용

**변경 후**
- `calcNameWidth()` 헬퍼 함수 추가 (Canvas API로 실제 텍스트 렌더링 너비 측정)
- 표1(일반/접두어)과 표2(익시드) 각각 해당 표에 실제 들어가는 행 이름들 기준으로 너비 개별 계산
  - 표1: `"일반"`, 접두어 이름들 중 가장 긴 것 기준
  - 표2: `"[선봉] 불굴"`, `"[의지] 숙련"` 등 익시드 행 이름 기준

---

### 2. 표 글자 가운데 정렬 (`equipment.js`)

**변경 전**
- 세트 이름 첫 번째 열 td가 `text-align:left`

**변경 후**
- 방어구/악세/특장 표의 세트 이름 열 전체 `text-align:center` 로 통일
- 적용 위치: `createEquipmentRow()`, 익시드 행 `tr.innerHTML` 생성부 (총 8곳)

---

### 3. 표 헤더에 슬롯 이름 추가 표시 (`equipment.js`)

**변경 전**
- 헤더에 아이템 이름만 표시
  ```
  | 어느 말괄량이의 가죽 자켓 | 어느 말괄량이의 버블 반바지 | ...
  ```

**변경 후**
- 헤더 상단에 슬롯 이름(회색 소자), 하단에 아이템 이름 표시
  ```
  |        상의         |          하의          | ...
  | 어느 말괄량이의 가죽 자켓 | 어느 말괄량이의 버블 반바지 | ...
  ```
- 적용 대상: 방어구 표2 `headerSlots2`, 악세 표1 `headerSlots1`, 특장 표1 `headerSlots1` (3곳)
- 슬롯 이름 스타일: `color:#888; font-size:0.85em;`

---

### 4. 최근 업데이트 팝업 아이템 이름 개선 (`weapon.js`)

**변경 전**
- 아이템 열에 세트 이름(저장 키)이 그대로 표시
  ```
  철갑을 두른 탑의 수호꾼
  초석: 신비로운 빛의 소용돌이
  [의지] 조화: 신비로운 빛의 소용돌이
  ```

**변경 후**
- 실제 아이템 이름을 앞에, 세트 이름을 괄호 안 회색으로 표시
- 접두어/익시드 태그는 아이템 이름 앞에 붙임
  ```
  메탈기어의 조작부 (철갑을 두른 탑의 수호꾼)
  초석: 은색의 별빛 (신비로운 빛의 소용돌이)
  [의지] 조화: 시린 달빛 (신비로운 빛의 소용돌이)
  ```
- **JSON 데이터 구조 변경 없음** - 표시 시점에만 변환, 기존 저장 데이터 호환 유지
- 구현 방식:
  - `showRecentUpdates()`에서 `ARMOR_DISPLAY_NAMES` / `ACCESSORY_DISPLAY_NAMES` / `SPECIAL_DISPLAY_NAMES` 조회
  - 배열 슬롯(익시드/일반 구분)은 `fullKey.startsWith('[')` 으로 판별
  - 조회 실패 시 `realItemName = null` → 기존 표시 방식 fallback
  - `renderUpdatePage()`에서 `displayItemCell` 로 최종 조합하여 렌더링

---

### 메모

- 로컬스토리지 용량: 캐릭터 20명 / 업데이트 약 1,280건 기준 **약 190KB** 수준으로 여유 있음 (한도 5MB)
- updateTimes는 count가 0이 되어도 삭제되지 않고 계속 누적되는 구조 → 향후 "count 0 항목 정리" 기능 추가 검토
