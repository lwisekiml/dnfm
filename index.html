<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RPG 통합 장비 관리 시스템</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>

<h2>🛡️ RPG 통합 장비 관리 시스템</h2>

<div class="control-bar">
    <button class="btn-action" onclick="exportToJSON()">📤 JSON 파일 저장</button>
    <button class="btn-action" onclick="saveJsonWithLocation()">📂 JSON 경로 지정 저장</button>
    <button class="btn-action" onclick="document.getElementById('fileInput').click()">📥 JSON 파일 불러오기</button>
    <button class="btn-action btn-add" onclick="createCharacterTable()">➕ 캐릭터 추가</button>
    <button onclick="lockAllCharacters()" class="btn-all-lock">전체 잠금</button>
    <button class="btn-action" style="background: var(--btn-info);" onclick="openHistoryModal()">📜 기록</button>
    <button class="btn-mode active" id="btnBasicMode" onclick="switchToBasicMode()">📋 기본</button>
    <button class="btn-mode" id="btnCompareMode" onclick="enterCompareMode()">⚖️ 비교</button>
    <button class="btn-mode" id="btnSearchMode" onclick="enterSearchMode()">🔍 검색</button>
    <button class="btn-mode" id="btnTagFilter" onclick="toggleTagFilterPanel()">🏷️ 태그</button>

    <input type="file" id="fileInput" class="d-none" accept=".json" onchange="importFromJSON(this)">
    <span id="statusMsg" class="status-msg"></span>
</div>

<div id="compareCharSelectionContainer">
    <h3 class="modal-title">⚖️ 비교할 캐릭터 선택</h3>
    <p>왼쪽과 오른쪽에서 각각 1명 씩을 선택해주세요.</p>
    <div class="compare-select-container">
        <!-- 왼쪽 선택 -->
        <div class="compare-select-wrapper">
            <label class="compare-select-label">⬅️ 왼쪽 선택</label>
            <select id="compareCharacterSelectLeft" class="compare-select">
                <option value="">캐릭터 선택...</option>
            </select>
        </div>

        <!-- 오른쪽 선택 -->
        <div class="compare-select-wrapper">
            <label class="compare-select-label">➡️ 오른쪽 선택</label>
            <select id="compareCharacterSelectRight" class="compare-select">
                <option value="">캐릭터 선택...</option>
            </select>
        </div>
    </div>
</div>

<!-- 비교 결과 UI -->
<div id="compareContainer">
    <div id="compareContent"></div>
</div>

<!-- 검색 모드 UI -->
<div id="searchContainer" style="display: none;">
    <h3 class="modal-title">🔍 슬롯 검색</h3>
    <div style="margin: 20px 0; text-align: center;">
        <select id="searchSlotSelect" style="
            width: 200px;
            height: 50px;
            font-size: 15px;
            font-weight: bold;
            background: #333333;
            color: #ffffff;
            border: 3px solid #ffd700;
            border-radius: 4px;
            padding: 10px;
            padding-right: 40px;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url('data:image/svg+xml;charset=UTF-8,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 24 24%27 fill=%27none%27 stroke=%27%23ffd700%27 stroke-width=%272%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27%3e%3cpolyline points=%276 9 12 15 18 9%27%3e%3c/polyline%3e%3c/svg%3e');
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 24px;
            cursor: pointer;">
            <option value="" disabled selected>▼ 슬롯 선택...</option>
        </select>
    </div>
    <div id="searchResultContent" style="margin-top: 20px;"></div>
</div>

<div id="characterContainer"></div>

<div class="modal-overlay" id="modalOverlay" onclick="closeRuneModal()"></div>

<!-- 스킬룬 모달 -->
<div id="skillRunemodal">
    <h3 class="modal-title">💎 스킬룬 & 각인 설정</h3>

    <div class="modal-flex-row">
        <select id="m-batch-rune-name" class="bg-row text-white border-gold modal-flex-col"></select>
        <button class="btn-action modal-flex-col-wide" style="background:var(--btn-add);" onclick="setAllRunesBatch()">룬 설정</button>
    </div>

    <div class="modal-flex-row">
        <select id="m-batch-rune-lv" class="bg-row text-white border-gold modal-flex-col"></select>
        <button class="btn-action modal-flex-col-wide" style="background:var(--btn-success);" onclick="setAllRuneLevels()">레벨 설정</button>
    </div>

    <div class="modal-flex-row">
        <select id="m-batch-skill-lv" class="bg-row text-white border-gold modal-flex-col"></select>
        <button class="btn-action modal-flex-col-wide" style="background:var(--btn-lock);" onclick="setAllSkillLevels()">레벨로 설정</button>
    </div>

    <table class="rune-modal-table">
        <thead>
        <tr class="text-gold">
            <th class="col-m-num">번호</th>
            <th style="width:68px;">스킬룬 이름</th>
            <th style="width:48px;">룬 레벨</th>
            <th style="width:50px;">스킬 레벨</th>
        </tr>
        </thead>
        <tbody id="runeModalBody"></tbody>
    </table>

    <div class="gakin-section">
        <div class="gakin-title">각인 설정</div>
        <div class="gakin-container">
            <div class="m-gakin-input-box"><input type="text" id="m-gakin1" placeholder="메인 미표시 (50%)"></div>
            <div class="m-gakin-input-box"><input type="text" id="m-gakin2" placeholder="메인 표시 (50%)"></div>
        </div>
    </div>

    <div class="modal-button-group">
        <button class="btn-action" style="background:var(--btn-success);" onclick="saveRuneData()">저장</button>
        <button class="btn-action" style="background:var(--btn-secondary);" onclick="closeRuneModal()">취소</button>
    </div>
</div>

<!-- 히스토리 모달 -->
<div id="historyModal">
    <h3 class="modal-title">📝 최근 변경 기록 (최근 10개)</h3>
    <div id="historyList"></div>
    <div class="modal-button-group text-center">
        <button class="btn-action" style="background:var(--btn-secondary);" onclick="closeHistoryModal()">닫기</button>
    </div>
</div>

<!-- ========================================
     캐릭터 테이블 템플릿 모음
     사용법: document.getElementById('템플릿ID').content.cloneNode(true)
======================================== -->

<!-- 1. 캐릭터 정보 칸 템플릿 -->
<template id="character-info-template">
    <td class="col-char-info bg-section" rowspan="18" style="vertical-align: top;">
        <div class="d-flex flex-column gap-sm" style="padding: var(--spacing-md);">
            <!-- 스탯/속강 선택 -->
            <div class="d-flex gap-sm">
                <select data-key="info_stat_type" class="info-select" onchange="applySealHighlight('{CHAR_ID}'); autoSave();">
                    <option value="">(스탯)</option>
                    <option value="힘">힘</option>
                    <option value="지능">지능</option>
                </select>
                <select data-key="info_ele_type" class="info-select" onchange="applySealHighlight('{CHAR_ID}'); autoSave();">
                    <option value=""></option>
                    <option value="화속강">화속강</option>
                    <option value="수속강">수속강</option>
                    <option value="명속강">명속강</option>
                    <option value="암속강">암속강</option>
                </select>
            </div>

            <div class="divider-gold"></div>

            <!-- 직업/이름/항마력 -->
            <input type="text" placeholder="직업" data-key="info_job" oninput="autoSave()">
            <input type="text" placeholder="이름" data-key="info_name" oninput="autoSave()">
            <input type="text" placeholder="항마력" data-key="info_power" oninput="autoSave()">

            <div class="divider-gold"></div>

            <!-- 메모 영역 -->
            <div style="margin-bottom: 8px;">
                <label class="memo-tag-label" style="display: block; margin-bottom: 4px;">
                    📝 메모
                </label>

                <!-- 메모 내용 표시 (클릭하면 편집) -->
                <div
                        id="{CHAR_ID}_memo_preview"
                        onclick="openMemoModal('{CHAR_ID}')"
                        style="padding: 8px 10px; background: rgba(255, 255, 255, 0.05);
               border: 1px solid #444; border-radius: 4px;
               font-size: 12px; color: #aaa; font-style: italic;
               min-height: 32px; cursor: pointer; transition: all 0.2s;">
                    (메모 없음)
                </div>

                <!-- 실제 메모 데이터는 숨겨진 textarea에 저장 -->
                <textarea
                        data-key="info_memo"
                        style="display: none;"
                        oninput="updateMemoPreview('{CHAR_ID}')"></textarea>
            </div>

            <!-- 태그 영역 -->
            <div>
                <label class="memo-tag-label">🏷️ 태그</label>
                <div style="display: flex; gap: 5px; margin-bottom: 5px;">
                    <input
                            data-key="info_tag_input"
                            type="text"
                            placeholder="#태그"
                            style="flex: 1; font-size: 13px;"
                            oninput="showTagAutocomplete('{CHAR_ID}', this.value)"
                            onkeydown="handleAutocompleteKeyboard(event, '{CHAR_ID}')"
                            onkeypress="handleTagInput(event, '{CHAR_ID}')">
                    <button
                            class="btn-action"
                            onclick="addTag('{CHAR_ID}')"
                            style="padding: 4px 8px; font-size: 12px; background: var(--btn-success);">
                        +
                    </button>
                </div>
                <div id="{CHAR_ID}_tags" class="tag-container"></div>
            </div>

            <div class="divider-gold"></div>

            <!-- 잠금 버튼 -->
            <button onclick="toggleEdit('{CHAR_ID}', true)" class="btn-char-lock lock-btn">잠금</button>
            <button onclick="toggleEdit('{CHAR_ID}', false)" class="btn-char-unlock unlock-btn">해제</button>

            <div class="divider-gold-lg"></div>

            <!-- 이동/삭제 버튼 -->
            <div class="d-flex gap-xs" style="margin-bottom: var(--spacing-sm);">
                <button onclick="moveCharacter('{CHAR_ID}', 'up')" class="btn-action btn-move">▲</button>
                <button onclick="moveCharacter('{CHAR_ID}', 'down')" class="btn-action btn-move">▼</button>
            </div>
            <button onclick="deleteCharacter('{CHAR_ID}')" class="del-btn">삭제</button>
        </div>
    </td>
</template>

<!-- 2. 일반 장비 행 템플릿 (무기~벨트) -->
<template id="equipment-row-template">
    <tr>
        <td class="col-slot v-border-heavy">{SLOT_NAME}</td>
        <td class="col-rarity">
            <select data-key="{SLOT}_rarity" data-slot="{SLOT}" onchange="updateStyle(this, 'rarity')" class="rare-에픽">
                <option>에픽</option>
                <option>유니크</option>
                <option>레어</option>
                <option>언커먼</option>
                <option>커먼</option>
                <option>티어</option>
            </select>
        </td>
        <td class="col-exceed">
            <select data-key="{SLOT}_exceed" data-slot="{SLOT}" onchange="updateStyle(this,'exceed')">
                <option></option>
                <option>이상</option>
                <option>선봉</option>
                <option>의지</option>
            </select>
        </td>
        <td class="col-prefix">
            <select data-key="{SLOT}_prefix" data-slot="{SLOT}" onchange="updateStyle(this,'prefix')">
                <option></option>
                <option>전격</option>
                <option>허상</option>
                <option>작열</option>
                <option>침식</option>
                <option>수호</option>
                <option>왜곡</option>
                <option>자상</option>
                <option>맹독</option>
                <option>보호</option>
                <option>쇄도</option>
                <option>신속</option>
                <option>연격</option>
            </select>
        </td>
        <td>
            <input type="text" data-key="{SLOT}_itemname" class="rare-에픽 itemname-color-sync" oninput="autoSave()">
        </td>
        <td class="col-val-short">
            <input type="text" data-key="{SLOT}_reinforce" oninput="autoSave()">
        </td>
        <td>
            <select data-key="{SLOT}_seal1" data-slot="{SLOT}" onchange="handleSealChange(this)">
                <option></option>
            </select>
        </td>
        <td class="col-val-short">
            <input type="text" data-key="{SLOT}_seal1_val" oninput="applySealHighlight('{CHAR_ID}'); autoSave();">
        </td>
        <td>
            <select data-key="{SLOT}_seal2" data-slot="{SLOT}" onchange="handleSealChange(this)">
                <option></option>
            </select>
        </td>
        <td class="col-val-short">
            <input type="text" data-key="{SLOT}_seal2_val" oninput="applySealHighlight('{CHAR_ID}'); autoSave();">
        </td>
        <td class="col-emblem {EMB_CLASS}">
            <input type="text" data-key="{SLOT}_emb1" oninput="autoSave()">
        </td>
        <td class="col-emblem {EMB_CLASS}">
            <input type="text" data-key="{SLOT}_emb2" oninput="autoSave()">
        </td>
        <td class="col-enchant">
            <input type="text" data-key="{SLOT}_enchant" value="{DEFAULT_ENCHANT}" oninput="autoSave()">
        </td>
        <td class="col-val-short">
            <input type="text" data-key="{SLOT}_enchant_val" value="{DEFAULT_ENCHANT_VAL}" oninput="autoSave()">
        </td>
        <td class="v-border-heavy">
            <input type="text" data-key="{SLOT}_desc" oninput="autoSave()" style="text-align: left; padding-left: 6px;">
        </td>
    </tr>
</template>

<!-- 3. 스킬룬 행 템플릿 -->
<template id="skillrune-row-template">
    <tr>
        <td class="col-slot v-border-heavy">스킬룬</td>
        <td colspan="3">
            <button class="btn-action" onclick="openRuneModal('{CHAR_ID}')" style="background:var(--btn-success); padding: var(--padding-sm);">수정</button>
            <button class="btn-action" onclick="resetRuneData('{CHAR_ID}')" style="background:var(--btn-secondary); padding: var(--padding-sm);">초기화</button>
        </td>
        <td colspan="10" id="{CHAR_ID}_runeSummary" class="text-left text-gold font-bold" style="padding-left: var(--spacing-xl); font-size: var(--fs-table);">
            설정된 룬 없음
        </td>
        <td class="v-border-heavy">
            <input type="text" data-key="스킬룬_desc" oninput="autoSave()" style="text-align: left; padding-left: 6px;">
        </td>
    </tr>
</template>

<!-- 4. 크리쳐 행 템플릿 -->
<template id="creature-row-template">
    <tr>
        <td class="col-slot v-border-heavy">크리쳐</td>
        <td class="col-rarity">
            <select data-key="크리쳐_rarity" onchange="updateStyle(this, 'rarity')" class="rare-에픽">
                <option>에픽</option>
                <option>유니크</option>
                <option>레어</option>
                <option>언커먼</option>
                <option>커먼</option>
            </select>
        </td>
        <td colspan="2">
            <input type="text" data-key="크리쳐_name" placeholder="크리쳐 이름" class="rare-에픽" oninput="autoSave()">
        </td>
        <td colspan="10">
            <div class="artifact-main-wrapper">
                <!-- Red 그룹 -->
                <div class="art-group">
                    <div class="art-item custom-top-line">
                        <select data-key="크리쳐_art_red_top_rarity" class="art-color-select bg-에픽" onchange="updateStyle(this, 'artBg')">
                            <option>에픽</option>
                            <option>유니크</option>
                            <option>레어</option>
                            <option>언커먼</option>
                            <option>커먼</option>
                        </select>
                        <input type="text" data-key="크리쳐_art_red_top_text" class="art-opt-select bg-에픽" placeholder="내용 입력" oninput="autoSave()">
                    </div>
                    <div class="art-item">
                        <select data-key="크리쳐_art_red_bg_1" class="art-color-select bg-에픽" onchange="updateStyle(this, 'artBg')">
                            <option>에픽</option>
                            <option>유니크</option>
                            <option>레어</option>
                            <option>언커먼</option>
                            <option>커먼</option>
                        </select>
                        <select data-key="크리쳐_art_red_opt_1" class="art-opt-select bg-에픽" onchange="autoSave()">
                            <option value="">옵션 선택</option>
                            <option>힘</option>
                            <option>지능</option>
                            <option>체력</option>
                            <option>정신력</option>
                            <option>적중</option>
                            <option>회피</option>
                        </select>
                    </div>
                    <div class="art-item">
                        <select data-key="크리쳐_art_red_bg_2" class="art-color-select bg-에픽" onchange="updateStyle(this, 'artBg')">
                            <option>에픽</option>
                            <option>유니크</option>
                            <option>레어</option>
                            <option>언커먼</option>
                            <option>커먼</option>
                        </select>
                        <select data-key="크리쳐_art_red_opt_2" class="art-opt-select bg-에픽" onchange="autoSave()">
                            <option value="">옵션 선택</option>
                            <option>힘</option>
                            <option>지능</option>
                            <option>체력</option>
                            <option>정신력</option>
                            <option>적중</option>
                            <option>회피</option>
                        </select>
                    </div>
                </div>

                <!-- Blue 그룹 -->
                <div class="art-group">
                    <div class="art-item custom-top-line">
                        <select data-key="크리쳐_art_blue_top_rarity" class="art-color-select bg-에픽" onchange="updateStyle(this, 'artBg')">
                            <option>에픽</option>
                            <option>유니크</option>
                            <option>레어</option>
                            <option>언커먼</option>
                            <option>커먼</option>
                        </select>
                        <input type="text" data-key="크리쳐_art_blue_top_text" class="art-opt-select bg-에픽" placeholder="내용 입력" oninput="autoSave()">
                    </div>
                    <div class="art-item">
                        <select data-key="크리쳐_art_blue_bg_1" class="art-color-select bg-에픽" onchange="updateStyle(this, 'artBg')">
                            <option>에픽</option>
                            <option>유니크</option>
                            <option>레어</option>
                            <option>언커먼</option>
                            <option>커먼</option>
                        </select>
                        <select data-key="크리쳐_art_blue_opt_1" class="art-opt-select bg-에픽" onchange="autoSave()">
                            <option value="">옵션 선택</option>
                            <option>HP MAX</option>
                            <option>MP MAX</option>
                            <option>물리 공격력</option>
                            <option>마법 공격력</option>
                            <option>물리 방어력</option>
                            <option>마법 방어력</option>
                        </select>
                    </div>
                    <div class="art-item">
                        <select data-key="크리쳐_art_blue_bg_2" class="art-color-select bg-에픽" onchange="updateStyle(this, 'artBg')">
                            <option>에픽</option>
                            <option>유니크</option>
                            <option>레어</option>
                            <option>언커먼</option>
                            <option>커먼</option>
                        </select>
                        <select data-key="크리쳐_art_blue_opt_2" class="art-opt-select bg-에픽" onchange="autoSave()">
                            <option value="">옵션 선택</option>
                            <option>HP MAX</option>
                            <option>MP MAX</option>
                            <option>물리 공격력</option>
                            <option>마법 공격력</option>
                            <option>물리 방어력</option>
                            <option>마법 방어력</option>
                        </select>
                    </div>
                </div>

                <!-- Green 그룹 -->
                <div class="art-group">
                    <div class="art-item custom-top-line">
                        <select data-key="크리쳐_art_green_top_rarity" class="art-color-select bg-에픽" onchange="updateStyle(this, 'artBg')">
                            <option>에픽</option>
                            <option>유니크</option>
                            <option>레어</option>
                            <option>언커먼</option>
                            <option>커먼</option>
                        </select>
                        <input type="text" data-key="크리쳐_art_green_top_text" class="art-opt-select bg-에픽" placeholder="내용 입력" oninput="autoSave()">
                    </div>
                    <div class="art-item">
                        <select data-key="크리쳐_art_green_bg_1" class="art-color-select bg-에픽" onchange="updateStyle(this, 'artBg')">
                            <option>에픽</option>
                            <option>유니크</option>
                            <option>레어</option>
                            <option>언커먼</option>
                            <option>커먼</option>
                        </select>
                        <select data-key="크리쳐_art_green_opt_1" class="art-opt-select bg-에픽" onchange="autoSave()">
                            <option value="">옵션 선택</option>
                            <option>물리 크리티컬</option>
                            <option>마법 크리티컬</option>
                            <option>공격속도</option>
                            <option>캐스팅속도</option>
                            <option>이동속도</option>
                            <option>화속강</option>
                            <option>수속강</option>
                            <option>명속강</option>
                            <option>암속강</option>
                            <option>모속강</option>
                        </select>
                    </div>
                    <div class="art-item">
                        <select data-key="크리쳐_art_green_bg_2" class="art-color-select bg-에픽" onchange="updateStyle(this, 'artBg')">
                            <option>에픽</option>
                            <option>유니크</option>
                            <option>레어</option>
                            <option>언커먼</option>
                            <option>커먼</option>
                        </select>
                        <select data-key="크리쳐_art_green_opt_2" class="art-opt-select bg-에픽" onchange="autoSave()">
                            <option value="">옵션 선택</option>
                            <option>물리 크리티컬</option>
                            <option>마법 크리티컬</option>
                            <option>공격속도</option>
                            <option>캐스팅속도</option>
                            <option>이동속도</option>
                            <option>화속강</option>
                            <option>수속강</option>
                            <option>명속강</option>
                            <option>암속강</option>
                            <option>모속강</option>
                        </select>
                    </div>
                </div>
            </div>
        </td>
        <td class="v-border-heavy">
            <input type="text" data-key="크리쳐_desc" oninput="autoSave()" style="text-align: left; padding-left: 6px;">
        </td>
    </tr>
</template>

<!-- 5. 칭호 행 템플릿 (textarea 포함) -->
<template id="title-row-template">
    <tr>
        <td class="col-slot v-border-heavy">칭호</td>
        <td class="col-rarity">
            <select data-key="칭호_rarity" data-slot="칭호" onchange="updateStyle(this, 'rarity')" class="rare-에픽">
                <option>에픽</option>
                <option>유니크</option>
                <option>레어</option>
                <option>언커먼</option>
                <option>커먼</option>
            </select>
        </td>
        <td>-</td>
        <td>-</td>
        <td>
            <input type="text" data-key="칭호_itemname" class="rare-에픽 itemname-color-sync" oninput="autoSave()">
        </td>
        <td class="col-val-short">-</td>
        <td>-</td>
        <td class="col-val-short">-</td>
        <td>-</td>
        <td class="col-val-short">-</td>
        <td class="col-emblem">
            <select data-key="칭호_emb1" class="emb-bg-gray" onchange="autoSave()">
                <option></option>
                <option>모속강</option>
                <option>화속강</option>
                <option>수속강</option>
                <option>명속강</option>
                <option>암속강</option>
                <option>힘</option>
                <option>지능</option>
            </select>
        </td>
        <td class="col-emblem emb-bg-gray">
            <input type="text" data-key="칭호_emb2" oninput="autoSave()">
        </td>
        <td class="col-enchant">
            <input type="text" data-key="칭호_enchant" oninput="autoSave()">
        </td>
        <td class="col-val-short">
            <input type="text" data-key="칭호_enchant_val" oninput="autoSave()">
        </td>
        <td rowspan="2" class="v-border-heavy" style="padding: var(--spacing-xs); vertical-align: middle;">
            <textarea data-key="칭호_desc" oninput="autoSave()" style="width:calc(100% - 4px); height:calc(100% - 2px); min-height: var(--height-textarea-min);"></textarea>
        </td>
    </tr>
</template>

<!-- 6-1. 외형칭호 행 템플릿 (설명 칸 없음 - 칭호와 rowspan 공유) -->
<template id="appearance-title-row-template">
    <tr>
        <td class="col-slot v-border-heavy">외형칭호</td>
        <td class="col-rarity">
            <select tabindex="-1" data-key="외형칭호_rarity" data-slot="외형칭호" onchange="updateStyle(this, 'rarity')" class="rare-에픽">
                <option>에픽</option>
                <option>유니크</option>
                <option>레어</option>
                <option>언커먼</option>
                <option>커먼</option>
            </select>
        </td>
        <td>-</td>
        <td>-</td>
        <td>
            <input tabindex="-1" type="text" data-key="외형칭호_itemname" class="rare-에픽 itemname-color-sync" oninput="autoSave()">
        </td>
        <td class="col-val-short">-</td>
        <td>-</td>
        <td class="col-val-short">-</td>
        <td>-</td>
        <td class="col-val-short">-</td>
        <td>-</td>
        <td>-</td>
        <td>-</td>
        <td class="col-val-short">-</td>
    </tr>
</template>

<!-- 6-2. 오라/아바타 행 템플릿 (설명 칸 있음) -->
<template id="simple-row-template">
    <tr>
        <td class="col-slot v-border-heavy">{SLOT_NAME}</td>
        <td class="col-rarity">
            <select tabindex="-1" data-key="{SLOT}_rarity" data-slot="{SLOT}" onchange="updateStyle(this, 'rarity')" class="rare-에픽">
                <option>에픽</option>
                <option>유니크</option>
                <option>레어</option>
                <option>언커먼</option>
                <option>커먼</option>
            </select>
        </td>
        <td>-</td>
        <td>-</td>
        <td>
            <input tabindex="-1" type="text" data-key="{SLOT}_itemname" class="rare-에픽 itemname-color-sync" oninput="autoSave()">
        </td>
        <td class="col-val-short">-</td>
        <td>-</td>
        <td class="col-val-short">-</td>
        <td>-</td>
        <td class="col-val-short">-</td>
        <td>-</td>
        <td>-</td>
        <td>-</td>
        <td class="col-val-short">-</td>
        <td class="v-border-heavy">
            <input type="text" data-key="{SLOT}_desc" oninput="autoSave()" style="text-align: left; padding-left: 6px;">
        </td>
    </tr>
</template>

<!-- 1. 상수 정의 -->
<script src="js/constants.js"></script>

<!-- 2. 게임 데이터 -->
<script src="js/data.js"></script>

<!-- 3. 상태 관리 -->
<script src="js/state.js"></script>

<!-- 4. 유틸리티 함수 -->
<script src="js/utils.js"></script>

<!-- 5. 저장/불러오기 -->
<script src="js/storage.js"></script>

<!-- 6. 핵심 UI 기능 -->
<script src="js/ui-core.js"></script>

<!-- 7. 캐릭터 관리 -->
<script src="js/ui-character.js"></script>

<!-- 8. 스킬룬 모달 -->
<script src="js/ui-rune.js"></script>

<!-- 9. 일반 모달 -->
<script src="js/ui-modal.js"></script>

<!-- 10. 비교 모드 -->
<script src="js/ui-compare.js"></script>

<!-- 11. 검색 모드 -->
<script src="js/ui-search.js"></script>

<script src="js/ui-templates.js"></script>

<!-- 메모/태그 기능 -->
<script src="js/ui-memo-tag.js"></script>

<script src="js/ui-tag-filter.js"></script>

<!-- 12. 메인 초기화 & 이벤트 -->
<script src="js/main.js"></script>

</body>
</html>